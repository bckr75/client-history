{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 4d92129cc095da7c4b98","webpack:///./src/index.js"],"names":["DEFAULTS","limit","ClientHistory","initObj","name","Error","defaults","checkFields","result","localStorage","getItem","JSON","parse","item","arr","getItems","length","push","setItem","stringify","shift","forEach","record","index","every","field","splice","removeItem","module","exports"],"mappings":"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","file":"lib.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"ClientHistory\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ClientHistory\"] = factory();\n\telse\n\t\troot[\"ClientHistory\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4d92129cc095da7c4b98","'use strict';\r\n\r\n/**\r\n * @const {object} DEFAULTS\r\n * @type {{limit: number}}\r\n */\r\n\r\nconst DEFAULTS = {\r\n    limit: 100,\r\n};\r\n\r\n/**\r\n * @classdesc Stores provided items in localHistory as JSON string.\r\n * @class ClientHistory\r\n */\r\n\r\nexport default class ClientHistory {\r\n\r\n    /**\r\n     * @constructor ClientHistory\r\n     * @throws Error\r\n     * @return {ClientHistory}\r\n     *\r\n     * @example\r\n     * new ClientHistory({\r\n     *      name: 'login',        //Mandatory. Array of items will be saved to localHistory with this name.\r\n     *      defaults: {           //Optional. If not set then class will use const DEFAULTS as defaults.\r\n     *          limit: 1000\r\n     *      },\r\n     *      checkFields: ['user'] //Optional. In case you want to store only unique items.\r\n     * }).push(...);\r\n     *\r\n     * @param {object} initObj\r\n     * @type {{name: string, defaults: Object|null, checkFields: Array|null}}\r\n     */\r\n\r\n    constructor(initObj) {\r\n        if (!initObj.name || typeof initObj.name !== 'string') {\r\n            throw new Error('Wrong ClientHistory constructor: initObj.name')\r\n        }\r\n        if (initObj.defaults && typeof initObj.defaults !== 'object') {\r\n            throw new Error('Wrong ClientHistory constructor: initObj.defaults')\r\n        }\r\n        if (initObj.checkFields && typeof initObj.checkFields !== 'object') {\r\n            throw new Error('Wrong ClientHistory constructor: initObj.checkFields')\r\n        }\r\n\r\n        this.name = initObj.name;\r\n        this.defaults = initObj.defaults || DEFAULTS;\r\n        this.checkFields = initObj.checkFields;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets all (this.name) items from localStorage.\r\n     * Returns parsed JSON string as array, empty array if items is not in localStorage.\r\n     * Notice: array will be returned as is, so recent items will be at the very end of it.\r\n     *\r\n     * @method getItems\r\n     * @returns {Array}\r\n     */\r\n\r\n    getItems() {\r\n        let result;\r\n        return (result = localStorage.getItem(this.name)) ? JSON.parse(result) : [];\r\n    }\r\n\r\n    /**\r\n     * Pushes item to array, array will be saved to localHistory as JSON string.\r\n     *\r\n     * If initObj.checkFields was set in constructor,\r\n     * method will check every localStorage item if its field(s) match(es) item field(s),\r\n     * if true, previous item will be dropped from array (splice),\r\n     * current item will be added at the end of the array.\r\n     *\r\n     * If array is too big (according to defaults.limit), the very first item will be dropped,\r\n     * current item will be added at the end of the array.\r\n     *\r\n     * @method push\r\n     * @param {Object} item\r\n     * @returns {ClientHistory}\r\n     * @throws Error\r\n     */\r\n\r\n    push(item) {\r\n        if (typeof item !== 'object') {\r\n            throw new Error(`Invalid argument type, expected 'object', got ${typeof item}`);\r\n        }\r\n        let arr = this.getItems();\r\n        if (!arr.length) {\r\n            arr.push(item);\r\n            localStorage.setItem(this.name, JSON.stringify(arr));\r\n            return this;\r\n        }\r\n        if (arr.length >= this.defaults.limit) {\r\n            arr.shift();\r\n        }\r\n        if (this.checkFields && typeof this.checkFields === \"object\") {\r\n            arr.forEach((record, index) => {\r\n                if (this.checkFields.every((field) => {\r\n                        if (typeof(record) === 'object') {\r\n                            return record[field] === item[field];\r\n                        }\r\n                    })) {\r\n                    return arr.splice(index, 1);\r\n                }\r\n            });\r\n        }\r\n        arr.push(item);\r\n        localStorage.setItem(this.name, JSON.stringify(arr));\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Clears localStorage for this.name\r\n     * @method drop\r\n     * @return {ClientHistory}\r\n     */\r\n\r\n    drop() {\r\n        localStorage.removeItem(this.name);\r\n        return this;\r\n    }\r\n}\r\nmodule.exports = ClientHistory;\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}